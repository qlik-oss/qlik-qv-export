


# qlik-qv-export
The Qlik-QV-Export-Tool is a tool intended to provide a convenient way for users making multiple QlikView documents available in Qlik Cloud Services.

There are two options to make your QlikView documents available in the cloud:

* You can create an comma separated file(csv) with links to the QlikView documents on your QlikView Server. This CSV can be imported on your Qlik Cloud Services Tennant adding the links to your hub.

* You can upload your QlikView documents to your personal space on your Qlik Cloud Services Tennant directly from your QlikView Server.
The tool is using QlikView QMS API and if it is running in DOC mode also Qlik Core/Collections API is used.

# How to use the application:
Qlik-QV-Export tool It is a command line tool and should be started via the command prompt with input parameters.

The -mode parameter decides if the tool should create a CSV file with links to a QlikView Server (-mode=Link), upload QlikView documents directly to the Qlik Cloud Services (-mode=doc) or migrate bookmarks from QlikView to cloud (-mode=migrate).

Example
```
qlik_qv_export.exe -mode=link -space=mySpace -protocol=http -qvscluster=QVS@myQVSCluster -qvwsmachine=QVWS@myQVWS -category=myCategory -filename=C:/QlikViewLinks/MyQvLinks.csv
 
or

qlik_qv_export.exe -mode=doc -cloudUrl=https://mycloud.somecloud.se/ -qvscluster=QVS@machineOne  -API_key=myTempApiKey -documentFolder=myMount

or

qlik_qv_export.exe -mode=migrate -uploadpath=C:\\ALL_R&D.QVW.zip -cloudUrl=https://QloudyMcCloudFace.com/ -appId=xxx-yyy-zzzz-xxx-yyy -api_key=12345
```
If only the required parameters are used, all user documents available on the QlikView Server will be added to the CSV file or uploaded to Qlik Cloud Services.

To limit the selection of QlikView documents, the input parameter -category (for Links) or -documentfolder (for Doc) should be used.

## Parameters (Link):

Parameter | Description
------------ | -------------
 -help |	Help text for the tool.
 -mode |	[Required] Which mode should the program run in.
-filename |	[Required] Name and path of csv file containing links
-qvscluster	| [Required] Name of QVS cluster as displayed in QMC
-qvwsmachine |	[Required] Name of QVWS as displayed in QMC
-space |	[Optional] The cloud space name
-protocol |	[Optional] The protocol used for connecting to Management Service. (Can be http or https. Defaults to http)
-category | 	[Optional] Only add links belonging to specified category. 


## Parameters (Doc):
Parameter | Description
------------ | -------------
 -help |	Help text for the tool.
-mode |	[Required] Which mode should the program run in.
-cloudUrl |	[Required] Url of cloud API endpoint, i.e target for document upload
-qvscluster |	[Required] Name of QVS cluster as displayed in QMC
-api_key |	[Required] The temporary API Key generated by cloud admin. The full key (484 characters), not the name or ID. 
-documentFolder	| [Optional] Name of QlikView server document folder, root or mount. All documents in folder will be uploaded. Leave empty for All Documents, type 'root' for QVS root folder

## Parameters (Migrate):
Parameter | Description
------------ | -------------
 -help |	Help text for the tool.
-mode |	[Required] Which mode should the program run in.
-cloudUrl |	[Required] Url of cloud API endpoint, i.e target for document upload
-appId |	[Required] The id of the app to which the bookmark belongs
-api_key |	[Required] The temporary API Key generated by cloud admin. The full key (484 characters), not the name or ID. 
-uploadpath	| [Required] The full path to the file being uploaded
-handledDirectory | [Optional] Directory to where to copy file after upload



## Files:
The tool consist of the following files that have to be present in the same folder:

* qlik_qv_export.exe
* qlik_qv_export.exe.config
* Newtonsoft.Json.dll
* Newtonsoft.Json.xml

## Prerequisites and Limitations:
1. The tool has to run on the same machine as the QlikView Management Service.
2. The account running the tool must be added to Windows Group "Qlikview Management API".
3. https/ssl for QMS is not supported.
4. Follow these instructions to get a temporary API Key https://help.qlik.com/en-US/sense-admin/November2019/Subsystems/DeployAdministerQSE/Content/Sense_DeployAdminister/QSEoK/Administer_QSEoK/mc-generate-api-keys.htm.
5. Modifying maxBufferSize and maxReceivedMessageSize could be needed if the number of QlikView links are too big. If this is the case the tool will throw the following exception:


>“Exception when exporting links, run help command for information about usage: Exeception:The maximum message >size quota for incoming messages (65536) has been exceeded. To increase the quota, use the >MaxReceivedMessageSize property on the appropriate binding element.” 

         

To mitigate this, increase the maxReceivedMessageSize and the maxBufferSize in the application config file for BasicHttpBinding_IQMS2.


```
Example
<binding name="BasicHttpBinding_IQMS2" maxBufferSize="2000000" maxReceivedMessageSize="2000000">
```

This value has to be changed in the config file of QlikView Management Service as well.

Change the tag <MaxReceivedMessageSize> in C:\Program Files\QlikView\Management Service\QVManagementService.exe.config and restart the QlikView Management Service.

6. If your input parameters contains a space, it must be written within quotation marks. E.G: -category="Category Containing Space" or -filename="C:/My CSV files/myLinks.csv". 

7. Two developers with different API keys can't upload the same document from the same QlikView Server to the same Qlik Cloud Services Tennant. A workaound for this is to make a copy of the QlikView document and upload the copy.
8. User must be a professional user. 